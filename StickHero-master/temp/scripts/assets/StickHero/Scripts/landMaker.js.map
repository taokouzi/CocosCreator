{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "spriteCreator",
    "require",
    "perfectLabel",
    "storageManager",
    "fsm",
    "StateMachine",
    "data",
    "gameDirector",
    "init",
    "transitions",
    "name",
    "from",
    "to",
    "methods",
    "onLeaveHeroTicked",
    "unregisterEvent",
    "onStickLengthen",
    "stickLengthen",
    "stick",
    "createStick",
    "x",
    "hero",
    "width",
    "anchorX",
    "ani",
    "getComponent",
    "cc",
    "Animation",
    "play",
    "onHeroTick",
    "onStickFall",
    "stickFall",
    "rotateBy",
    "easing",
    "easeIn",
    "callFunc",
    "stickLength",
    "height",
    "currentLandRange",
    "secondLand",
    "heroMoveToStickEnd",
    "heroMoveToLand",
    "perfect",
    "getScore",
    "pl",
    "showPerfect",
    "se",
    "sequence",
    "runAction",
    "onHeroMoveToLand",
    "stop",
    "landMove",
    "heroMove",
    "length",
    "onLandMove",
    "registerEvent",
    "landCreateAndMove",
    "onHeroMoveToStickEnd",
    "heroDown",
    "onHeroDown",
    "gameOver",
    "stickAndHeroDownAction",
    "onGameOver",
    "overLabel",
    "node",
    "active",
    "onRestart",
    "director",
    "loadScene",
    "Class",
    "extends",
    "Component",
    "properties",
    "landRange",
    "v2",
    "landWidth",
    "Node",
    "firstLand",
    "moveDuration",
    "stickSpeed",
    "heroMoveSpeed",
    "stickWidth",
    "canvas",
    "scoreLabel",
    "Label",
    "hightestScoreLabel",
    "onLoad",
    "runLength",
    "score",
    "heroWorldPosX",
    "changeHightestScoreLabel",
    "createNewLand",
    "range",
    "getLandRange",
    "setPosition",
    "on",
    "event",
    "target",
    "EventType",
    "TOUCH_START",
    "touchStart",
    "bind",
    "TOUCH_END",
    "touchEnd",
    "TOUCH_CANCEL",
    "touchCancel",
    "console",
    "log",
    "targetOff",
    "update",
    "dt",
    "heroTick",
    "stickAction",
    "heroAction",
    "moveBy",
    "p",
    "seq",
    "time",
    "winSize",
    "getWinSize",
    "action",
    "l",
    "secondAction",
    "parent",
    "getLandWidth",
    "num",
    "getHighestScore",
    "setHighestScore",
    "string",
    "y",
    "Math",
    "random",
    "module",
    "exports"
  ],
  "mappings": ";;AAAA,IAAIA,gBAAgBC,QAAQ,eAAR,CAApB;AACA,IAAIC,eAAeD,QAAQ,cAAR,CAAnB;AACA,IAAIE,iBAAiBF,QAAQ,gBAAR,CAArB;AACA,IAAIG,MAAM,IAAIC,YAAJ,CAAiB;AACvBC,UAAK;AACDC,sBAAa;AADZ,KADkB;AAIvBC,UAAM,OAJiB;AAKvBC,iBAAY,CACR,EAACC,MAAK,eAAN,EAAsBC,MAAK,OAA3B,EAAmCC,IAAG,iBAAtC,EADQ,EAER,EAACF,MAAK,UAAN,EAAiBC,MAAK,iBAAtB,EAAwCC,IAAG,YAA3C,EAFQ,EAGR,EAACF,MAAK,WAAN,EAAkBC,MAAK,YAAvB,EAAoCC,IAAG,aAAvC,EAHQ,EAIR,EAACF,MAAK,gBAAN,EAAuBC,MAAK,aAA5B,EAA0CC,IAAG,iBAA7C,EAJQ,EAKR,EAACF,MAAK,UAAN,EAAiBC,MAAK,iBAAtB,EAAwCC,IAAG,OAA3C,EALQ,EAMR,EAACF,MAAK,oBAAN,EAA2BC,MAAK,aAAhC,EAA8CC,IAAG,qBAAjD,EANQ,EAOR,EAACF,MAAK,UAAN,EAAiBC,MAAK,qBAAtB,EAA4CC,IAAG,YAA/C,EAPQ,EAQR,EAACF,MAAK,UAAN,EAAiBC,MAAK,YAAtB,EAAmCC,IAAG,KAAtC,EARQ,EASR,EAACF,MAAK,SAAN,EAAgBC,MAAK,KAArB,EAA2BC,IAAG,OAA9B,EATQ,CALW;AAgBvBC,aAAQ;AACJC,yBADI,+BACe;AACfP,yBAAaQ,eAAb;AACH,SAHG;AAIJC,uBAJI,6BAIa;AACbT,yBAAaU,aAAb,GAA6B,IAA7B;AACAV,yBAAaW,KAAb,GAAqBX,aAAaY,WAAb,EAArB;AACAZ,yBAAaW,KAAb,CAAmBE,CAAnB,GAAuBb,aAAac,IAAb,CAAkBD,CAAlB,GAAsBb,aAAac,IAAb,CAAkBC,KAAlB,IAA2B,IAAEf,aAAac,IAAb,CAAkBE,OAA/C,CAAtB,GAAgFhB,aAAaW,KAAb,CAAmBI,KAAnB,GAA2Bf,aAAaW,KAAb,CAAmBK,OAArJ;AACA,gBAAIC,MAAMjB,aAAac,IAAb,CAAkBI,YAAlB,CAA+BC,GAAGC,SAAlC,CAAV;AACAH,gBAAII,IAAJ,CAAS,UAAT;AACH,SAVG;AAWJC,kBAXI,wBAWQ;AACRtB,yBAAaU,aAAb,GAA6B,KAA7B;AACA,gBAAIO,MAAMjB,aAAac,IAAb,CAAkBI,YAAlB,CAA+BC,GAAGC,SAAlC,CAAV;AACAH,gBAAII,IAAJ,CAAS,UAAT;AACH,SAfG;AAgBJE,mBAhBI,yBAgBS;AACT;AACA,gBAAIC,YAAYL,GAAGM,QAAH,CAAY,GAAZ,EAAiB,EAAjB,CAAhB;AACAD,sBAAUE,MAAV,CAAiBP,GAAGQ,MAAH,CAAU,CAAV,CAAjB;AACA,gBAAIC,WAAWT,GAAGS,QAAH,CAAY,YAAU;AACjC,oBAAIC,cAAc7B,aAAaW,KAAb,CAAmBmB,MAAnB,GAA0B9B,aAAaW,KAAb,CAAmBI,KAAnB,GAA2Bf,aAAaW,KAAb,CAAmBK,OAA1F;AACA,oBAAGa,cAAc7B,aAAa+B,gBAA3B,IAA+CF,cAAc7B,aAAa+B,gBAAb,GAA8B/B,aAAagC,UAAb,CAAwBjB,KAAtH,EAA4H;AAAC;AACzHlB,wBAAIoC,kBAAJ;AACH,iBAFD,MAEK;AAAC;AACFpC,wBAAIqC,cAAJ;AACA,wBAAGL,cAAc7B,aAAa+B,gBAAb,GAAgC/B,aAAagC,UAAb,CAAwBjB,KAAxB,GAA8B,CAA9D,GAAgE,CAA9E,IACGc,cAAc7B,aAAa+B,gBAAb,GAAgC/B,aAAagC,UAAb,CAAwBjB,KAAxB,GAA8B,CAA9D,GAAgE,CADpF,EACsF;AAClFf,qCAAamC,OAAb;AACAnC,qCAAaoC,QAAb,CAAsBpC,aAAamC,OAAnC;AACA,4BAAIE,KAAKrC,aAAaL,YAAb,CAA0BuB,YAA1B,CAAuCvB,YAAvC,CAAT;AACA0C,2BAAGC,WAAH,CAAetC,aAAamC,OAA5B;AACH,qBAND,MAMK;AACDnC,qCAAamC,OAAb,GAAuB,CAAvB;AACH;AACJ;AACJ,aAhBc,CAAf;AAiBA,gBAAII,KAAIpB,GAAGqB,QAAH,CAAYhB,SAAZ,EAAsBI,QAAtB,CAAR;AACA5B,yBAAaW,KAAb,CAAmB8B,SAAnB,CAA6BF,EAA7B;AACH,SAvCG;AAwCJG,wBAxCI,8BAwCc;AACd,gBAAIzB,MAAMjB,aAAac,IAAb,CAAkBI,YAAlB,CAA+BC,GAAGC,SAAlC,CAAV;AACA,gBAAIQ,WAAWT,GAAGS,QAAH,CAAY,YAAU;AACjCX,oBAAI0B,IAAJ,CAAS,SAAT;AACA3C,6BAAaoC,QAAb;AACAvC,oBAAI+C,QAAJ;AACH,aAJc,CAAf;AAKA3B,gBAAII,IAAJ,CAAS,SAAT;AACArB,yBAAa6C,QAAb,CAAsB7C,aAAac,IAAnC,EAAwC,EAACgC,QAAO9C,aAAa+B,gBAAb,GAA8B/B,aAAagC,UAAb,CAAwBjB,KAA9D,EAAoEa,UAASA,QAA7E,EAAxC;AACH,SAjDG;AAkDJmB,kBAlDI,wBAkDQ;AACR,gBAAInB,WAAWT,GAAGS,QAAH,CAAY,YAAU;AACjC5B,6BAAagD,aAAb;AACH,aAFc,CAAf;AAGAhD,yBAAaiD,iBAAb,CAA+BrB,QAA/B;AACH,SAvDG;AAwDJsB,4BAxDI,kCAwDkB;AAClB,gBAAIjC,MAAMjB,aAAac,IAAb,CAAkBI,YAAlB,CAA+BC,GAAGC,SAAlC,CAAV;AACA,gBAAIQ,WAAWT,GAAGS,QAAH,CAAY,YAAU;AACjCX,oBAAI0B,IAAJ,CAAS,SAAT;AACA9C,oBAAIsD,QAAJ;AACH,aAHc,CAAf;AAIAlC,gBAAII,IAAJ,CAAS,SAAT;AACArB,yBAAa6C,QAAb,CAAsB7C,aAAac,IAAnC,EAAwC,EAACgC,QAAO9C,aAAaW,KAAb,CAAmBmB,MAA3B,EAAkCF,UAASA,QAA3C,EAAxC;AACH,SAhEG;AAiEJwB,kBAjEI,wBAiEQ;AACP,gBAAIxB,WAAWT,GAAGS,QAAH,CAAY,YAAU;AAClC/B,oBAAIwD,QAAJ;AACH,aAFe,CAAf;AAGDrD,yBAAasD,sBAAb,CAAoC1B,QAApC;AACH,SAtEG;AAuEJ2B,kBAvEI,wBAuEQ;AACRvD,yBAAawD,SAAb,CAAuBC,IAAvB,CAA4BC,MAA5B,GAAqC,IAArC;AACH,SAzEG;AA0EJC,iBA1EI,uBA0EO;AACPxC,eAAGyC,QAAH,CAAYC,SAAZ,CAAsB,eAAtB;AACH;AA5EG;AAhBe,CAAjB,CAAV;AA+FA,IAAI7D,eAAe,IAAnB;AACAmB,GAAG2C,KAAH,CAAS;AACLC,aAAS5C,GAAG6C,SADP;AAELC,gBAAY;AACRC,mBAAU/C,GAAGgD,EAAH,CAAM,EAAN,EAAS,GAAT,CADF;AAERC,mBAAUjD,GAAGgD,EAAH,CAAM,EAAN,EAAS,GAAT,CAFF;AAGRrD,cAAKK,GAAGkD,IAHA;AAIRC,mBAAUnD,GAAGkD,IAJL;AAKRrC,oBAAWb,GAAGkD,IALN;AAMRE,sBAAa,GANL;AAORC,oBAAW,GAPH;AAQRC,uBAAc,GARN;AASR;AACA;AACAC,oBAAW,CAXH;AAYRC,gBAAOxD,GAAGkD,IAZF;AAaRO,oBAAWzD,GAAG0D,KAbN;AAcRC,4BAAmB3D,GAAG0D,KAdd;AAeRrB,mBAAUrC,GAAG0D,KAfL;AAgBRlF,sBAAawB,GAAGkD;AAhBR,KAFP;AAoBLU,YAAQ,kBAAY;AAChB;AACA;AACA/E,uBAAe,IAAf;AACA,aAAKgF,SAAL,GAAiB,CAAjB,EACA,KAAKrE,KAAL,GAAa,IADb;AAEA,aAAKD,aAAL,GAAqB,KAArB;AACA,aAAKuE,KAAL,GAAa,CAAb;AACA,aAAK9C,OAAL,GAAe,CAAf;AACA,aAAKJ,gBAAL,GAAwB,CAAxB;AACA,aAAKmD,aAAL,GAAqB,CAArB;AACA,aAAKC,wBAAL;;AAEA;AACA,aAAKC,aAAL;AACA,YAAIC,QAAQ,KAAKC,YAAL,EAAZ;AACA,aAAKJ,aAAL,GAAqB,KAAKZ,SAAL,CAAevD,KAAf,GAAuB,CAAC,IAAE,KAAKD,IAAL,CAAUE,OAAb,IAAwB,KAAKF,IAAL,CAAUC,KAAzD,GAAiE,KAAK2D,UAA3F;AACA,aAAK1C,UAAL,CAAgBuD,WAAhB,CAA4BF,QAAM,KAAKf,SAAL,CAAevD,KAAjD,EAAuD,CAAvD;;AAEA,aAAKiC,aAAL;AACA;AACA,YAAI/B,MAAMjB,aAAac,IAAb,CAAkBI,YAAlB,CAA+BC,GAAGC,SAAlC,CAAV;AACAH,YAAIuE,EAAJ,CAAO,MAAP,EAAc,UAACC,KAAD,EAAS;AACnB,gBAAGA,MAAMC,MAAN,CAAavF,IAAb,IAAoB,UAAvB,EAAkC;AAC9BN,oBAAI2B,SAAJ;AACH;AACJ,SAJD;AAKH,KA/CI;AAgDLwB,iBAhDK,2BAgDU;AACX,aAAK2B,MAAL,CAAYa,EAAZ,CAAerE,GAAGkD,IAAH,CAAQsB,SAAR,CAAkBC,WAAjC,EAA8C,KAAKC,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAA9C,EAA0E,KAAKrC,IAA/E;AACA,aAAKkB,MAAL,CAAYa,EAAZ,CAAerE,GAAGkD,IAAH,CAAQsB,SAAR,CAAkBI,SAAjC,EAA2C,KAAKC,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAA3C,EAAqE,KAAKrC,IAA1E;AACA,aAAKkB,MAAL,CAAYa,EAAZ,CAAerE,GAAGkD,IAAH,CAAQsB,SAAR,CAAkBM,YAAjC,EAA8C,KAAKC,WAAL,CAAiBJ,IAAjB,CAAsB,IAAtB,CAA9C,EAA2E,KAAKrC,IAAhF;AACA0C,gBAAQC,GAAR,CAAY,IAAZ;AACH,KArDI;AAsDL5F,mBAtDK,6BAsDY;AACb,aAAKmE,MAAL,CAAY0B,SAAZ,CAAsB,KAAK5C,IAA3B;AACA0C,gBAAQC,GAAR,CAAY,KAAZ;AACH,KAzDI;AA0DLE,UA1DK,kBA0DEC,EA1DF,EA0DK;AACN;AACA,YAAG,KAAK7F,aAAR,EAAsB;AAClB,iBAAKC,KAAL,CAAWmB,MAAX,IAAqByE,KAAG,KAAK/B,UAA7B;AACA;AACH;AACJ,KAhEI;AAiELqB,cAjEK,sBAiEMJ,KAjEN,EAiEY;AACb5F,YAAIa,aAAJ;AACAS,WAAGiF,GAAH,CAAO,YAAP;AACH,KApEI;AAqELJ,YArEK,oBAqEIP,KArEJ,EAqEU;AACX5F,YAAI2G,QAAJ;AACArF,WAAGiF,GAAH,CAAO,UAAP;AACH,KAxEI;AAyELF,eAzEK,yBAyEQ;AACT,aAAKF,QAAL;AACA7E,WAAGiF,GAAH,CAAO,aAAP;AACH,KA5EI;AA6EL9C,0BA7EK,kCA6EkB1B,QA7ElB,EA6E2B;AAC5B;AACA,YAAI6E,cAActF,GAAGM,QAAH,CAAY,GAAZ,EAAiB,EAAjB,CAAlB;AACAgF,oBAAY/E,MAAZ,CAAmBP,GAAGQ,MAAH,CAAU,CAAV,CAAnB;AACA,aAAKhB,KAAL,CAAW8B,SAAX,CAAqBgE,WAArB;AACA;AACA,YAAIC,aAAavF,GAAGwF,MAAH,CAAU,GAAV,EAAcxF,GAAGyF,CAAH,CAAK,CAAL,EAAO,CAAC,GAAD,GAAO,KAAK9F,IAAL,CAAUgB,MAAxB,CAAd,CAAjB;AACA4E,mBAAWhF,MAAX,CAAkBP,GAAGQ,MAAH,CAAU,CAAV,CAAlB;AACA,YAAIkF,MAAK1F,GAAGqB,QAAH,CAAYkE,UAAZ,EAAuB9E,QAAvB,CAAT;AACA,aAAKd,IAAL,CAAU2B,SAAV,CAAoBoE,GAApB;AACH,KAvFI;AAwFLhE,YAxFK,oBAwFI6C,MAxFJ,EAwFW3F,IAxFX,EAwFgB;AACjB,YAAI+G,OAAO/G,KAAK+C,MAAL,GAAY,KAAK2B,aAA5B;AACA,YAAI5B,WAAW1B,GAAGwF,MAAH,CAAUG,IAAV,EAAe3F,GAAGyF,CAAH,CAAK7G,KAAK+C,MAAV,EAAiB,CAAjB,CAAf,CAAf;AACA,YAAG/C,KAAK6B,QAAR,EAAiB;AACb,gBAAIW,KAAIpB,GAAGqB,QAAH,CAAYK,QAAZ,EAAqB9C,KAAK6B,QAA1B,CAAR;AACA,iBAAKd,IAAL,CAAU2B,SAAV,CAAoBF,EAApB;AACH,SAHD,MAGK;AACD,iBAAKzB,IAAL,CAAU2B,SAAV,CAAoBI,QAApB;AACH;AACJ,KAjGI;AAkGLI,qBAlGK,6BAkGarB,QAlGb,EAkGuB;AACxB,YAAImF,UAAU5F,GAAGyC,QAAH,CAAYoD,UAAZ,EAAd;AACA;AACA,YAAIlE,SAAS,KAAKf,gBAAL,GAAwB,KAAKC,UAAL,CAAgBjB,KAArD;AACA,aAAKiE,SAAL,IAAiBlC,MAAjB;AACA,YAAImE,SAAS9F,GAAGwF,MAAH,CAAU,KAAKpC,YAAf,EAA4BpD,GAAGyF,CAAH,CAAK,CAAC9D,MAAN,EAAa,CAAb,CAA5B,CAAb;AACA,aAAKW,IAAL,CAAUhB,SAAV,CAAoBwE,MAApB;AACA,aAAK3C,SAAL,GAAiB,KAAKtC,UAAtB;;AAEA,aAAKoD,aAAL;;AAEA;AACA,YAAIC,QAAQ,KAAKC,YAAL,EAAZ;;AAEA;AACA,aAAKtD,UAAL,CAAgBuD,WAAhB,CAA4B,KAAKP,SAAL,GAAe+B,QAAQhG,KAAnD,EAAyD,CAAzD;AACA,YAAImG,IAAIH,QAAQhG,KAAR,GAAgBsE,KAAhB,GAAwB,KAAKH,aAA7B,GAA6C,KAAKpE,IAAL,CAAUC,KAAV,GAAkB,KAAKD,IAAL,CAAUE,OAAzE,GAAmF,KAAK0D,UAAhG;AACA,YAAIyC,eAAehG,GAAGwF,MAAH,CAAU,KAAKpC,YAAf,EAA4BpD,GAAGyF,CAAH,CAAK,CAACM,CAAN,EAAQ,CAAR,CAA5B,CAAnB;AACA,YAAIL,MAAK1F,GAAGqB,QAAH,CAAY2E,YAAZ,EAAyBvF,QAAzB,CAAT;AACA,aAAKI,UAAL,CAAgBS,SAAhB,CAA0BoE,GAA1B;AACH,KAtHI;AAuHLjG,eAvHK,yBAuHQ;AACTO,WAAGiF,GAAH,CAAO,IAAP;AACA,YAAIzF,QAAQlB,cAAcmB,WAAd,CAA0B,KAAK8D,UAA/B,CAAZ;AACA/D,cAAMyG,MAAN,GAAe,KAAK3D,IAApB;AACA,eAAO9C,KAAP;AACH,KA5HI;AA6HLyE,iBA7HK,2BA6HW;AACZ,aAAKpD,UAAL,GAAkBvC,cAAc2F,aAAd,CAA4B,KAAKiC,YAAL,EAA5B,CAAlB;AACA,aAAKrF,UAAL,CAAgBoF,MAAhB,GAAyB,KAAK3D,IAA9B;AACH,KAhII;AAiILrB,YAjIK,oBAiIIkF,GAjIJ,EAiIQ;AACT,YAAGA,GAAH,EAAO;AACH,iBAAKrC,KAAL,IAAcqC,GAAd;AACH,SAFD,MAEK;AACD,iBAAKrC,KAAL;AACH;AACD,YAAGrF,eAAe2H,eAAf,KAAiC,KAAKtC,KAAzC,EAA+C;AAC3CrF,2BAAe4H,eAAf,CAA+B,KAAKvC,KAApC;AACA,iBAAKE,wBAAL;AACH;AACD,aAAKP,UAAL,CAAgB6C,MAAhB,GAAyB,QAAM,KAAKxC,KAApC;AACH,KA5II;AA6ILE,4BA7IK,sCA6IqB;AACtB,aAAKL,kBAAL,CAAwB2C,MAAxB,GAAiC,SAAS7H,eAAe2H,eAAf,EAA1C;AACH,KA/II;AAgJLjC,gBAhJK,0BAgJS;AACV,aAAKvD,gBAAL,GAAwB,KAAKmC,SAAL,CAAerD,CAAf,GAAkB,CAAC,KAAKqD,SAAL,CAAewD,CAAf,GAAmB,KAAKxD,SAAL,CAAerD,CAAnC,IAAsC8G,KAAKC,MAAL,EAAhF;AACA,YAAIb,UAAU5F,GAAGyC,QAAH,CAAYoD,UAAZ,EAAd;AACA,YAAGD,QAAQhG,KAAR,GAAgB,KAAKgB,gBAAL,GAAwB,KAAKmD,aAA7B,GAA6C,KAAKpE,IAAL,CAAUC,KAAvD,GAA+D,KAAKiB,UAAL,CAAgBjB,KAAlG,EAAwG;AACpG,iBAAKgB,gBAAL,GAAwBgF,QAAQhG,KAAR,GAAgB,KAAKmE,aAArB,GAAqC,KAAKpE,IAAL,CAAUC,KAA/C,GAAuD,KAAKiB,UAAL,CAAgBjB,KAA/F;AACH;AACD,eAAO,KAAKgB,gBAAZ;AACH,KAvJI;AAwJLsF,gBAxJK,0BAwJS;AACV,eAAO,KAAKjD,SAAL,CAAevD,CAAf,GAAmB,CAAC,KAAKuD,SAAL,CAAesD,CAAf,GAAmB,KAAKtD,SAAL,CAAevD,CAAnC,IAAuC8G,KAAKC,MAAL,EAAjE;AACH;AA1JI,CAAT;AA4JAC,OAAOC,OAAP,GAAiBjI,GAAjB",
  "file": "unknown",
  "sourcesContent": [
    "var spriteCreator = require(\"spriteCreator\");\nvar perfectLabel = require(\"perfectLabel\");\nvar storageManager = require(\"storageManager\");\nvar fsm = new StateMachine({\n    data:{\n        gameDirector:null,\n    },\n    init: 'stand',\n    transitions:[\n        {name:'stickLengthen',from:'stand',to:'stickLengthened'},\n        {name:'heroTick',from:'stickLengthened',to:'heroTicked'},\n        {name:'stickFall',from:'heroTicked',to:'stickFalled'},\n        {name:'heroMoveToLand',from:'stickFalled',to:'heroMovedToLand'},\n        {name:'landMove',from:'heroMovedToLand',to:'stand'},\n        {name:'heroMoveToStickEnd',from:'stickFalled',to:'heroMovedToStickEnd'},\n        {name:'heroDown',from:'heroMovedToStickEnd',to:'heroDowned'},\n        {name:'gameOver',from:'heroDowned',to:'end'},\n        {name:'restart',from:'end',to:'stand'},\n    ],\n    methods:{\n        onLeaveHeroTicked(){\n            gameDirector.unregisterEvent();\n        },\n        onStickLengthen(){\n            gameDirector.stickLengthen = true;\n            gameDirector.stick = gameDirector.createStick();\n            gameDirector.stick.x = gameDirector.hero.x + gameDirector.hero.width * (1-gameDirector.hero.anchorX) + gameDirector.stick.width * gameDirector.stick.anchorX;\n            var ani = gameDirector.hero.getComponent(cc.Animation);\n            ani.play('heroPush');\n        },\n        onHeroTick(){\n            gameDirector.stickLengthen = false;\n            var ani = gameDirector.hero.getComponent(cc.Animation);\n            ani.play('heroTick');\n        },\n        onStickFall(){\n            //stick fall action.\n            var stickFall = cc.rotateBy(0.5, 90);\n            stickFall.easing(cc.easeIn(3));\n            var callFunc = cc.callFunc(function(){\n                var stickLength = gameDirector.stick.height-gameDirector.stick.width * gameDirector.stick.anchorX;\n                if(stickLength < gameDirector.currentLandRange || stickLength > gameDirector.currentLandRange+gameDirector.secondLand.width){//failed.\n                    fsm.heroMoveToStickEnd();\n                }else{//successed\n                    fsm.heroMoveToLand();\n                    if(stickLength > gameDirector.currentLandRange + gameDirector.secondLand.width/2-5 \n                        &&stickLength < gameDirector.currentLandRange + gameDirector.secondLand.width/2+5){\n                        gameDirector.perfect ++;\n                        gameDirector.getScore(gameDirector.perfect);\n                        var pl = gameDirector.perfectLabel.getComponent(perfectLabel);\n                        pl.showPerfect(gameDirector.perfect);\n                    }else{\n                        gameDirector.perfect = 0;\n                    }\n                }\n            });\n            var se =cc.sequence(stickFall,callFunc);\n            gameDirector.stick.runAction(se);\n        },\n        onHeroMoveToLand(){\n            var ani = gameDirector.hero.getComponent(cc.Animation);\n            var callFunc = cc.callFunc(function(){\n                ani.stop('heroRun');\n                gameDirector.getScore();\n                fsm.landMove();\n            });\n            ani.play('heroRun');\n            gameDirector.heroMove(gameDirector.hero,{length:gameDirector.currentLandRange+gameDirector.secondLand.width,callFunc:callFunc});\n        },\n        onLandMove(){\n            var callFunc = cc.callFunc(function(){\n                gameDirector.registerEvent();\n            });\n            gameDirector.landCreateAndMove(callFunc);\n        },\n        onHeroMoveToStickEnd(){\n            var ani = gameDirector.hero.getComponent(cc.Animation);\n            var callFunc = cc.callFunc(function(){\n                ani.stop('heroRun');\n                fsm.heroDown();\n            });\n            ani.play('heroRun');\n            gameDirector.heroMove(gameDirector.hero,{length:gameDirector.stick.height,callFunc:callFunc});\n        },\n        onHeroDown(){\n             var callFunc = cc.callFunc(function(){\n                fsm.gameOver();\n            });\n            gameDirector.stickAndHeroDownAction(callFunc);\n        },\n        onGameOver(){\n            gameDirector.overLabel.node.active = true;\n        },\n        onRestart(){\n            cc.director.loadScene(\"MainGameScene\");\n        }\n    }\n});\nvar gameDirector = null;\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        landRange:cc.v2(20,300),\n        landWidth:cc.v2(20,200),\n        hero:cc.Node,\n        firstLand:cc.Node,\n        secondLand:cc.Node,\n        moveDuration:0.5,\n        stickSpeed:400,\n        heroMoveSpeed:400,\n        // stick:cc.Node,\n        // stickLengthen:false,\n        stickWidth:6,\n        canvas:cc.Node,\n        scoreLabel:cc.Label,\n        hightestScoreLabel:cc.Label,\n        overLabel:cc.Label,\n        perfectLabel:cc.Node\n    },\n    onLoad: function () {\n        //init data\n        // alert(storageManager.getHighestScore());\n        gameDirector = this;\n        this.runLength = 0,\n        this.stick = null;\n        this.stickLengthen = false;\n        this.score = 0;\n        this.perfect = 0;\n        this.currentLandRange = 0;\n        this.heroWorldPosX = 0;\n        this.changeHightestScoreLabel();\n\n        //create new land;\n        this.createNewLand();\n        var range = this.getLandRange();\n        this.heroWorldPosX = this.firstLand.width - (1-this.hero.anchorX) * this.hero.width - this.stickWidth;\n        this.secondLand.setPosition(range+this.firstLand.width,0);\n        \n        this.registerEvent();\n        //init hero animation callback.\n        var ani = gameDirector.hero.getComponent(cc.Animation);\n        ani.on('stop',(event)=>{\n            if(event.target.name =='heroTick'){\n                fsm.stickFall();\n            }\n        });\n    },\n    registerEvent(){\n        this.canvas.on(cc.Node.EventType.TOUCH_START, this.touchStart.bind(this), this.node);\n        this.canvas.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this), this.node);\n        this.canvas.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel.bind(this), this.node);\n        console.log(\"on\");\n    },\n    unregisterEvent(){\n        this.canvas.targetOff(this.node);\n        console.log(\"off\");\n    },\n    update(dt){\n        // console.log(dt);\n        if(this.stickLengthen){\n            this.stick.height += dt*this.stickSpeed;\n            // this.stick.height = this.currentLandRange + this.secondLand.width/2;\n        }\n    },\n    touchStart(event){\n        fsm.stickLengthen();\n        cc.log(\"touchStart\");\n    },\n    touchEnd(event){\n        fsm.heroTick();\n        cc.log(\"touchEnd\");\n    },\n    touchCancel(){\n        this.touchEnd();\n        cc.log(\"touchCancel\");\n    },\n    stickAndHeroDownAction(callFunc){\n        //stick down action;\n        var stickAction = cc.rotateBy(0.5, 90);\n        stickAction.easing(cc.easeIn(3));\n        this.stick.runAction(stickAction);\n        //hero down action;\n        var heroAction = cc.moveBy(0.5,cc.p(0,-300 - this.hero.height));\n        heroAction.easing(cc.easeIn(3));\n        var seq =cc.sequence(heroAction,callFunc);\n        this.hero.runAction(seq);\n    },\n    heroMove(target,data){\n        var time = data.length/this.heroMoveSpeed;\n        var heroMove = cc.moveBy(time,cc.p(data.length,0));\n        if(data.callFunc){\n            var se =cc.sequence(heroMove,data.callFunc);\n            this.hero.runAction(se);\n        }else{\n            this.hero.runAction(heroMove);\n        }\n    },\n    landCreateAndMove(callFunc) {\n        var winSize = cc.director.getWinSize();\n        //firstland;\n        var length = this.currentLandRange + this.secondLand.width;\n        this.runLength +=length;\n        var action = cc.moveBy(this.moveDuration,cc.p(-length,0));\n        this.node.runAction(action);\n        this.firstLand = this.secondLand;\n\n        this.createNewLand();\n\n        //landRange\n        var range = this.getLandRange();\n\n        //secondland;\n        this.secondLand.setPosition(this.runLength+winSize.width,0);\n        var l = winSize.width - range - this.heroWorldPosX - this.hero.width * this.hero.anchorX - this.stickWidth;\n        var secondAction = cc.moveBy(this.moveDuration,cc.p(-l,0));\n        var seq =cc.sequence(secondAction,callFunc);\n        this.secondLand.runAction(seq);\n    },\n    createStick(){\n        cc.log(\"sc\");\n        var stick = spriteCreator.createStick(this.stickWidth);\n        stick.parent = this.node;\n        return stick\n    },\n    createNewLand() {\n        this.secondLand = spriteCreator.createNewLand(this.getLandWidth());\n        this.secondLand.parent = this.node;\n    },\n    getScore(num){\n        if(num){\n            this.score += num;  \n        }else{\n            this.score++;\n        }\n        if(storageManager.getHighestScore()<this.score){\n            storageManager.setHighestScore(this.score);\n            this.changeHightestScoreLabel();\n        }\n        this.scoreLabel.string = \"得分:\"+this.score;\n    },\n    changeHightestScoreLabel(){\n        this.hightestScoreLabel.string = \"最高分:\" + storageManager.getHighestScore();\n    },\n    getLandRange(){\n        this.currentLandRange = this.landRange.x +(this.landRange.y - this.landRange.x)*Math.random();\n        var winSize = cc.director.getWinSize();\n        if(winSize.width < this.currentLandRange + this.heroWorldPosX + this.hero.width + this.secondLand.width){\n            this.currentLandRange = winSize.width - this.heroWorldPosX - this.hero.width - this.secondLand.width;\n        }\n        return this.currentLandRange;\n    },\n    getLandWidth(){\n        return this.landWidth.x + (this.landWidth.y - this.landWidth.x)* Math.random();\n    }\n});\nmodule.exports = fsm;"
  ]
}